{"remainingRequest":"/Users/syu/Private/datacradle/map-prototype-vector-tile/map-prototype-vector-tile-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/syu/Private/datacradle/map-prototype-vector-tile/map-prototype-vector-tile-frontend/src/components/Map.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/syu/Private/datacradle/map-prototype-vector-tile/map-prototype-vector-tile-frontend/src/components/Map.vue","mtime":1579675829986},{"path":"/Users/syu/Private/datacradle/map-prototype-vector-tile/map-prototype-vector-tile-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/syu/Private/datacradle/map-prototype-vector-tile/map-prototype-vector-tile-frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/syu/Private/datacradle/map-prototype-vector-tile/map-prototype-vector-tile-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/syu/Private/datacradle/map-prototype-vector-tile/map-prototype-vector-tile-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBMIGZyb20gJ2xlYWZsZXQnCmltcG9ydCAibGVhZmxldC9kaXN0L2xlYWZsZXQuY3NzIgppbXBvcnQgImxlYWZsZXQudmVjdG9yZ3JpZCIKCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICdNYXAnLAogICAgY29tcG9uZW50czp7fSwKICAgIGRhdGEgKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGNsaWNrZWRUaWxlSWQ6IG51bGwsCiAgICAgICAgfQogICAgfSwKICAgIG1vdW50ZWQgKCkgewogICAgICAgIHRoaXMuZHJhd01hcCgpCiAgICAgICAgdGhpcy5yZW5kZXJTaGFwZSgpCiAgICB9LAogICAgY29tcHV0ZWQ6IHsKICAgICAgICBzaGFyZWRTdGF0ZSAoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZQogICAgICAgIH0sCiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIGRyYXdNYXAgKCkgewogICAgICAgICAgICBjb25zdCBvc210aWxlID0gTC50aWxlTGF5ZXIoJy8ve3N9LnRpbGUub3NtLm9yZy97en0ve3h9L3t5fS5wbmcnLCB7CiAgICAgICAgICAgICAgICB6SW5kZXg6IDEsCiAgICAgICAgICAgICAgICBhdHRyaWJ1dGlvbjogJyZjb3B5OyA8YSBocmVmPSIvL29zbS5vcmcvY29weXJpZ2h0Ij5PcGVuU3RyZWV0TWFwPC9hPiBjb250cmlidXRvcnMnCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIGNvbnN0IGdzaXN0ZHRpbGUgPSBMLnRpbGVMYXllcignaHR0cHM6Ly9jeWJlcmphcGFuZGF0YS5nc2kuZ28uanAveHl6L3N0ZC97en0ve3h9L3t5fS5wbmcnLCB7CiAgICAgICAgICAgICAgICB6SW5kZXg6IDEsCiAgICAgICAgICAgICAgICBhdHRyaWJ1dGlvbjogIjxhIGhyZWY9J2h0dHBzOi8vbWFwcy5nc2kuZ28uanAvZGV2ZWxvcG1lbnQvaWNoaXJhbi5odG1sJyB0YXJnZXQ9J19ibGFuayc+5Zyw55CG6Zmi44K/44Kk44OrPC9hPiIKICAgICAgICAgICAgfSkKICAgICAgICAgICAgY29uc3QgbWFwID0gTC5tYXAoJ21hcCcsIHsgCiAgICAgICAgICAgICAgICBjZW50ZXI6IFszNC41NCwgMTMzLjc0NV0sCiAgICAgICAgICAgICAgICB6b29tOiAxMSwKICAgICAgICAgICAgICAgIGxheWVyczogW29zbXRpbGVdLAogICAgICAgICAgICAgICAgem9vbUNvbnRyb2w6IGZhbHNlLAogICAgICAgICAgICAgICAgbWluWm9vbTogNiwKICAgICAgICAgICAgICAgIG1heFpvb206IDE3LAogICAgICAgICAgICAgICAgZ2VzdHVyZUhhbmRsaW5nOiB0cnVlLAogICAgICAgICAgICAgICAgcHJlZmVyQ2FudmFzOiB0cnVlLAogICAgICAgICAgICAgICAgc2Nyb2xsV2hlZWxab29tOiBmYWxzZQogICAgICAgICAgICB9KQogICAgICAgICAgICBMLmNvbnRyb2wuem9vbSh7IHBvc2l0aW9uOiAnYm90dG9tcmlnaHQnIH0pLmFkZFRvKG1hcCkKICAgICAgICAgICAgY29uc3QgbWFwT2JqID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpCiAgICAgICAgICAgIG1hcE9iai5hZGRFdmVudExpc3RlbmVyKCJmb2N1cyIsICgpID0+IHttYXAuc2Nyb2xsV2hlZWxab29tLmVuYWJsZSgpfSk7CiAgICAgICAgICAgIG1hcE9iai5hZGRFdmVudExpc3RlbmVyKCJibHVyIiwgKCkgPT4ge21hcC5zY3JvbGxXaGVlbFpvb20uZGlzYWJsZSgpfSk7CgogICAgICAgICAgICBMLmNvbnRyb2wuc2NhbGUoe2ltcGVyaWFsOmZhbHNlfSkuYWRkVG8obWFwKQoKICAgICAgICAgICAgTC5jb250cm9sLmxheWVycyh7CiAgICAgICAgICAgICAgIk9wZW5TdHJlZXRNYXAiOiBvc210aWxlLAogICAgICAgICAgICAgICLlm73lnJ/lnLDnkIbpmaIgLSDmqJnmupblnLDlm7MiOiBnc2lzdGR0aWxlLAogICAgICAgICAgICB9KS5hZGRUbyhtYXApCiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0TWFwJywgbWFwKQogICAgICAgIH0sCiAgICAgICAgcmVuZGVyU2hhcGUgKCkgewogICAgICAgICAgICBjb25zdCB2ZWN0b3JMYXllciA9IEwudmVjdG9yR3JpZC5wcm90b2J1ZigiaHR0cDovL2xvY2FsaG9zdDoyNjExL2RhdGEva3VyYXNoaWtpL3t6fS97eH0ve3l9LnBiZiIsIHsKICAgICAgICAgICAgICAgIHJlbmRlcmVyRmFjdG9yeTogTC5jYW52YXMudGlsZSwKICAgICAgICAgICAgICAgIGdldEZlYXR1cmVJZDogZnVuY3Rpb24oZil7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcoZi5wcm9wZXJ0aWVzWyJLRVlfQ09ERSJdKQogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGYpIC8vZXNsaW50LWRpc2FibGUtbGluZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGludGVyYWN0aXZlOiB0cnVlLAogICAgICAgICAgICAgICAgdmVjdG9yVGlsZUxheWVyU3R5bGVzOnsKICAgICAgICAgICAgICAgICAgICAia3VyYXNoaWtpIjp0aGlzLnNoYXJlZFN0YXRlLmluaXRpYWxUaWxlU3R5bGUKICAgICAgICAgICAgICAgIH0sCgogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRWZWN0b3JUaWxlSW5zdGFuY2UnLHZlY3RvckxheWVyKQogICAgICAgICAgICB2ZWN0b3JMYXllci5vbigiY2xpY2siLCAoZSk9PnsKICAgICAgICAgICAgICAgIHRoaXMuY2xpY2tlZFRpbGVJZCA9IGUubGF5ZXIucHJvcGVydGllc1siS0VZX0NPREUiXTsKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuY2xpY2tlZFRpbGVJZCkgLy9lc2xpbnQtZGlzYWJsZS1saW5lCiAgICAgICAgICAgICAgICB2ZWN0b3JMYXllci5iaW5kUG9wdXAodGhpcy5jbGlja2VkVGlsZUlkKQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdhZGRMYXllcicsIHZlY3RvckxheWVyKSAgCgogICAgICAgIH0sCiAgICAgICAgc2V0RmVhdHVyZVN0eWxlQXN5bmMobmV3dmFsLG9sZHZhbCl7CiAgICAgICAgICAgIGlmKG9sZHZhbCl7CiAgICAgICAgICAgICAgICB0aGlzLnNoYXJlZFN0YXRlLnZlY3RvclRpbGVJbnN0YW5jZS5zZXRGZWF0dXJlU3R5bGUob2xkdmFsLHRoaXMuc2hhcmVkU3RhdGUuaW5pdGlhbFRpbGVTdHlsZSkKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnNoYXJlZFN0YXRlLnZlY3RvclRpbGVJbnN0YW5jZS5zZXRGZWF0dXJlU3R5bGUobmV3dmFsLHsKICAgICAgICAgICAgICAgIGZpbGw6dHJ1ZSwKICAgICAgICAgICAgICAgIGZpbGxDb2xvcjogInJlZCIsCiAgICAgICAgICAgICAgICBjb2xvcjogImdyZWVuIgogICAgICAgICAgICB9KQogICAgICAgIH0sCgogICAgfSwKICAgIHdhdGNoOiB7CiAgICAgICAgY2xpY2tlZFRpbGVJZDogZnVuY3Rpb24obmV3dmFsLG9sZHZhbCl7CiAgICAgICAgICAgIHRoaXMuc2V0RmVhdHVyZVN0eWxlQXN5bmMobmV3dmFsLG9sZHZhbCkKICAgICAgICB9CiAgICB9Cn0K"},{"version":3,"sources":["Map.vue"],"names":[],"mappings":";;;;;;;;AAQA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Map.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <section class=\"container\">\n        <div id=\"map\"></div>\n    </section>\n\n</template>\n\n<script>\n    import L from 'leaflet'\n    import \"leaflet/dist/leaflet.css\"\n    import \"leaflet.vectorgrid\"\n\n    export default {\n        name: 'Map',\n        components:{},\n        data () {\n            return {\n                clickedTileId: null,\n            }\n        },\n        mounted () {\n            this.drawMap()\n            this.renderShape()\n        },\n        computed: {\n            sharedState () {\n                return this.$store.state\n            },\n        },\n        methods: {\n            drawMap () {\n                const osmtile = L.tileLayer('//{s}.tile.osm.org/{z}/{x}/{y}.png', {\n                    zIndex: 1,\n                    attribution: '&copy; <a href=\"//osm.org/copyright\">OpenStreetMap</a> contributors'\n                })\n                const gsistdtile = L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png', {\n                    zIndex: 1,\n                    attribution: \"<a href='https://maps.gsi.go.jp/development/ichiran.html' target='_blank'>地理院タイル</a>\"\n                })\n                const map = L.map('map', { \n                    center: [34.54, 133.745],\n                    zoom: 11,\n                    layers: [osmtile],\n                    zoomControl: false,\n                    minZoom: 6,\n                    maxZoom: 17,\n                    gestureHandling: true,\n                    preferCanvas: true,\n                    scrollWheelZoom: false\n                })\n                L.control.zoom({ position: 'bottomright' }).addTo(map)\n                const mapObj = document.getElementById('map')\n                mapObj.addEventListener(\"focus\", () => {map.scrollWheelZoom.enable()});\n                mapObj.addEventListener(\"blur\", () => {map.scrollWheelZoom.disable()});\n\n                L.control.scale({imperial:false}).addTo(map)\n\n                L.control.layers({\n                  \"OpenStreetMap\": osmtile,\n                  \"国土地理院 - 標準地図\": gsistdtile,\n                }).addTo(map)\n                this.$store.commit('setMap', map)\n            },\n            renderShape () {\n                const vectorLayer = L.vectorGrid.protobuf(\"http://localhost:2611/data/kurashiki/{z}/{x}/{y}.pbf\", {\n                    rendererFactory: L.canvas.tile,\n                    getFeatureId: function(f){\n\n                        return String(f.properties[\"KEY_CODE\"])\n                        // console.log(f) //eslint-disable-line\n                    },\n                    interactive: true,\n                    vectorTileLayerStyles:{\n                        \"kurashiki\":this.sharedState.initialTileStyle\n                    },\n\n                });\n                this.$store.commit('setVectorTileInstance',vectorLayer)\n                vectorLayer.on(\"click\", (e)=>{\n                    this.clickedTileId = e.layer.properties[\"KEY_CODE\"];\n                    // console.log(this.clickedTileId) //eslint-disable-line\n                    vectorLayer.bindPopup(this.clickedTileId)\n                });\n                    \n                \n                this.$store.commit('addLayer', vectorLayer)  \n\n            },\n            setFeatureStyleAsync(newval,oldval){\n                if(oldval){\n                    this.sharedState.vectorTileInstance.setFeatureStyle(oldval,this.sharedState.initialTileStyle)\n                }\n                this.sharedState.vectorTileInstance.setFeatureStyle(newval,{\n                    fill:true,\n                    fillColor: \"red\",\n                    color: \"green\"\n                })\n            },\n\n        },\n        watch: {\n            clickedTileId: function(newval,oldval){\n                this.setFeatureStyleAsync(newval,oldval)\n            }\n        }\n    }\n</script>\n\n<style scoped>\n\n#map {\n  height: 500px;\n  width: 800px;\n  margin: auto;\n}\n\n</style>\n"]}]}