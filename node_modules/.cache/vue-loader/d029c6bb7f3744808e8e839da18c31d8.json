{"remainingRequest":"/Users/syu/Private/datacradle/map-prototype-vector-tile/map-prototype-vector-tile-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/syu/Private/datacradle/map-prototype-vector-tile/map-prototype-vector-tile-frontend/src/components/Map.vue?vue&type=style&index=0&id=3074bd5c&scoped=true&lang=css&","dependencies":[{"path":"/Users/syu/Private/datacradle/map-prototype-vector-tile/map-prototype-vector-tile-frontend/src/components/Map.vue","mtime":1579675829986},{"path":"/Users/syu/Private/datacradle/map-prototype-vector-tile/map-prototype-vector-tile-frontend/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/syu/Private/datacradle/map-prototype-vector-tile/map-prototype-vector-tile-frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/syu/Private/datacradle/map-prototype-vector-tile/map-prototype-vector-tile-frontend/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/syu/Private/datacradle/map-prototype-vector-tile/map-prototype-vector-tile-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/syu/Private/datacradle/map-prototype-vector-tile/map-prototype-vector-tile-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgojbWFwIHsKICBoZWlnaHQ6IDUwMHB4OwogIHdpZHRoOiA4MDBweDsKICBtYXJnaW46IGF1dG87Cn0KCg=="},{"version":3,"sources":["Map.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8GA;AACA;AACA;AACA;AACA","file":"Map.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <section class=\"container\">\n        <div id=\"map\"></div>\n    </section>\n\n</template>\n\n<script>\n    import L from 'leaflet'\n    import \"leaflet/dist/leaflet.css\"\n    import \"leaflet.vectorgrid\"\n\n    export default {\n        name: 'Map',\n        components:{},\n        data () {\n            return {\n                clickedTileId: null,\n            }\n        },\n        mounted () {\n            this.drawMap()\n            this.renderShape()\n        },\n        computed: {\n            sharedState () {\n                return this.$store.state\n            },\n        },\n        methods: {\n            drawMap () {\n                const osmtile = L.tileLayer('//{s}.tile.osm.org/{z}/{x}/{y}.png', {\n                    zIndex: 1,\n                    attribution: '&copy; <a href=\"//osm.org/copyright\">OpenStreetMap</a> contributors'\n                })\n                const gsistdtile = L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png', {\n                    zIndex: 1,\n                    attribution: \"<a href='https://maps.gsi.go.jp/development/ichiran.html' target='_blank'>地理院タイル</a>\"\n                })\n                const map = L.map('map', { \n                    center: [34.54, 133.745],\n                    zoom: 11,\n                    layers: [osmtile],\n                    zoomControl: false,\n                    minZoom: 6,\n                    maxZoom: 17,\n                    gestureHandling: true,\n                    preferCanvas: true,\n                    scrollWheelZoom: false\n                })\n                L.control.zoom({ position: 'bottomright' }).addTo(map)\n                const mapObj = document.getElementById('map')\n                mapObj.addEventListener(\"focus\", () => {map.scrollWheelZoom.enable()});\n                mapObj.addEventListener(\"blur\", () => {map.scrollWheelZoom.disable()});\n\n                L.control.scale({imperial:false}).addTo(map)\n\n                L.control.layers({\n                  \"OpenStreetMap\": osmtile,\n                  \"国土地理院 - 標準地図\": gsistdtile,\n                }).addTo(map)\n                this.$store.commit('setMap', map)\n            },\n            renderShape () {\n                const vectorLayer = L.vectorGrid.protobuf(\"http://localhost:2611/data/kurashiki/{z}/{x}/{y}.pbf\", {\n                    rendererFactory: L.canvas.tile,\n                    getFeatureId: function(f){\n\n                        return String(f.properties[\"KEY_CODE\"])\n                        // console.log(f) //eslint-disable-line\n                    },\n                    interactive: true,\n                    vectorTileLayerStyles:{\n                        \"kurashiki\":this.sharedState.initialTileStyle\n                    },\n\n                });\n                this.$store.commit('setVectorTileInstance',vectorLayer)\n                vectorLayer.on(\"click\", (e)=>{\n                    this.clickedTileId = e.layer.properties[\"KEY_CODE\"];\n                    // console.log(this.clickedTileId) //eslint-disable-line\n                    vectorLayer.bindPopup(this.clickedTileId)\n                });\n                    \n                \n                this.$store.commit('addLayer', vectorLayer)  \n\n            },\n            setFeatureStyleAsync(newval,oldval){\n                if(oldval){\n                    this.sharedState.vectorTileInstance.setFeatureStyle(oldval,this.sharedState.initialTileStyle)\n                }\n                this.sharedState.vectorTileInstance.setFeatureStyle(newval,{\n                    fill:true,\n                    fillColor: \"red\",\n                    color: \"green\"\n                })\n            },\n\n        },\n        watch: {\n            clickedTileId: function(newval,oldval){\n                this.setFeatureStyleAsync(newval,oldval)\n            }\n        }\n    }\n</script>\n\n<style scoped>\n\n#map {\n  height: 500px;\n  width: 800px;\n  margin: auto;\n}\n\n</style>\n"]}]}